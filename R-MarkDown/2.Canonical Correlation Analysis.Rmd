---
title: "Canonical Correlation Analysis"
author: "Humaun Farid Sohag"
date: "2025-08-13"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## **#Step 1. Load dataset**

```{r}
mm <- read.csv("mmreg.csv")

# Rename columns for clarity
colnames(mm) <- c("Control", "Concept", "Motivation", "Read", "Write", "Math", "Science", "Sex")
colnames(mm)
head(mm)
```

## **#Step 2. Descriptive statistics**

```{r}
summary(mm)
xtabs(~Sex, data = mm)  # frequency table for Sex
```

## **#Step 3. Load required packages**

```{r message=FALSE, warning=FALSE}
library(ggplot2)
library(GGally)   # for ggpairs
library(CCA)      # Canonical Correlation Analysis
library(CCP)      # Significance testing of canonical correlations
```

## **#Step 4. Split dataset into psychological and academic variables**

```{r}
psych <- mm[, 1:3]  # locus_of_control, self_concept, motivation
acad  <- mm[, 4:8]  # read, write, math, science, sex
```

## **#Step 5. Exploratory data analysis**

```{r}
ggpairs(psych)  # pairwise plots for psychological variables
```

## **#Step 6. Compute correlation matrix between two sets**

```{r}
matcor(psych, acad)
```

## **#Step 7. Perform canonical correlation analysis**

```{r}
cc1 <- cc(psych, acad)

# Display canonical correlations
cc1$cor
```

## **#Step 8. Compute canonical loadings**

```{r}
cc2 <- comput(psych, acad, cc1)

# Display canonical loadings (X & Y scores)
cc2[3:6]
```

## **#Step 9. Tests of canonical dimensions**

```{r}
rho <- cc1$cor
n   <- nrow(psych)   # number of observations
p   <- ncol(psych)   # number of variables in set 1
q   <- ncol(acad)    # number of variables in set 2

# Calculate p-values using different F-approximations
p.asym(rho, n, p, q, tstat = "Wilks")
p.asym(rho, n, p, q, tstat = "Hotelling")
p.asym(rho, n, p, q, tstat = "Pillai")
p.asym(rho, n, p, q, tstat = "Roy")
```

## **#Step 10. Standardized canonical coefficients**

```{r}
# Psychological variables
s1 <- diag(sqrt(diag(cov(psych))))
std_xcoef <- s1 %*% cc1$xcoef
std_xcoef

# Academic variables
s2 <- diag(sqrt(diag(cov(acad))))
std_ycoef <- s2 %*% cc1$ycoef
std_ycoef
```
